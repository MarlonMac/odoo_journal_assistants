<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_account_payment_form_assistant_inherit" model="ir.ui.view">
        <field name="name">account.payment.form.assistant.inherit</field>
        <field name="model">account.payment</field>
        <field name="inherit_id" ref="account.view_account_payment_form"/>
        <field name="arch" type="xml">
            <xpath expr="//sheet" position="inside">
                <notebook>
                    <page string="Documentos" name="attachments">
                        
                        <style>
                            /* Forzamos al iframe dentro de nuestra clase a ocupar el 100% del contenedor padre */
                            .force-pdf-height iframe {
                                height: 100% !important;
                                min-height: 80vh !important;
                                width: 100% !important;
                                border: none !important;
                            }
                            /* Ajuste para que la imagen también respete el contenedor sin deformarse */
                            .force-img-height img {
                                object-fit: contain;
                                max-height: 80vh;
                                width: auto;
                                margin: 0 auto;
                            }
                        </style>

                        <div class="alert alert-secondary" role="status" style="margin-bottom: 5px; padding: 5px 15px;">
                            <group>
                                <field name="attachment_ids" widget="many2many_binary" string="Adjuntar Comprobante"/>
                            </group>
                        </div>

                        <div style="background-color: #555; padding: 0; min-height: 80vh; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                            
                            <field name="preview_filename" invisible="1"/>

                            <field name="preview_pdf" widget="pdf_viewer" nolabel="1" 
                                   class="force-pdf-height"
                                   attrs="{'invisible': [('preview_pdf', '=', False)]}" 
                                   style="width: 100%; height: 80vh;"/>
                            
                            <field name="preview_image" widget="image" nolabel="1" 
                                   class="force-img-height"
                                   attrs="{'invisible': [('preview_image', '=', False)]}" 
                                   style="max-width: 100%; max-height: 80vh;"/>

                            <div attrs="{'invisible': ['|', ('preview_pdf', '!=', False), ('preview_image', '!=', False)]}" 
                                 class="text-center" 
                                 style="color: #ccc;">
                                <h3 style="color: #fff;">Sin Vista Previa</h3>
                                <p>Suba un documento para visualizarlo aquí.</p>
                            </div>
                        </div>
                    </page>
                </notebook>
            </xpath>
        </field>
    </record>
</odoo>